!function(){"use strict";L.Marker.Measurement=L[L.Layer?"Layer":"Class"].extend({options:{pane:"markerPane"},initialize:function(t,e,n,s,i){L.setOptions(this,i),this._latlng=t,this._measurement=e,this._title=n,this._rotation=s},addTo:function(t){return t.addLayer(this),this},onAdd:function(t){this._map=t;var e=this.getPane?this.getPane():t.getPanes().markerPane,n=this._element=L.DomUtil.create("div","leaflet-zoom-animated leaflet-measure-path-measurement",e),s=L.DomUtil.create("div","",n);s.title=this._title,s.innerHTML=this._measurement,t.on("zoomanim",this._animateZoom,this),this._setPosition()},onRemove:function(t){t.off("zoomanim",this._animateZoom,this),(this.getPane?this.getPane():t.getPanes().markerPane).removeChild(this._element),this._map=null},_setPosition:function(){L.DomUtil.setPosition(this._element,this._map.latLngToLayerPoint(this._latlng)),this._element.style.transform+=" rotate("+this._rotation+"rad)"},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();L.DomUtil.setPosition(this._element,e),this._element.style.transform+=" rotate("+this._rotation+"rad)"}}),L.marker.measurement=function(t,e,n,s,i){return new L.Marker.Measurement(t,e,n,s,i)};var t=function(t){var e;return e="hex",(t/=1.16).toFixed(2)+" "+e},e=function(){this.showMeasurements()},n=function(t,e,n){return n?function(){return e.apply(this,arguments),t.apply(this,arguments)}:function(){var n=t.apply(this,arguments),s=Array.prototype.slice.call(arguments);return s.push(n),e.apply(this,s)}};L.Polyline.include({showMeasurements:function(t){return!this._map||this._measurementLayer?this:(this._measurementOptions=L.extend({showOnHover:t&&t.showOnHover||!1,minPixelDistance:30,showDistances:!0,showArea:!0,lang:{totalLength:"Total length",totalArea:"Total area",segmentLength:"Segment length"}},t||{}),this._measurementLayer=L.layerGroup().addTo(this._map),this.updateMeasurements(),this._map.on("zoomend",this.updateMeasurements,this),this)},hideMeasurements:function(){return this._map?(this._map.off("zoomend",this.updateMeasurements,this),this._measurementLayer?(this._map.removeLayer(this._measurementLayer),this._measurementLayer=null,this):this):this},onAdd:n(L.Polyline.prototype.onAdd,function(t){var e=this.options.measurementOptions&&this.options.measurementOptions.showOnHover;return this.options.showMeasurements&&!e&&this.showMeasurements(this.options.measurementOptions),t}),onRemove:n(L.Polyline.prototype.onRemove,function(t){return this.hideMeasurements(),t},!0),setLatLngs:n(L.Polyline.prototype.setLatLngs,function(t){return this.updateMeasurements(),t}),spliceLatLngs:n(L.Polyline.prototype.spliceLatLngs,function(t){return this.updateMeasurements(),t}),formatDistance:t,updateMeasurements:function(){if(!this._measurementLayer)return this;var t,e,n,s,i,a=this.getLatLngs(),o=this instanceof L.Polygon,r=this._measurementOptions,m=0;if(a&&a.length&&L.Util.isArray(a[0])&&(a=a[0]),this._measurementLayer.clearLayers(),this._measurementOptions.showDistances&&a.length>1){t=this._measurementOptions.formatDistance||L.bind(this.formatDistance,this);for(var h=1,u=a.length;o&&h<=u||h<u;h++)e=a[h-1],n=a[h%u],m+=this._map.distance(e,n),s=this._map.latLngToLayerPoint(e),i=this._map.latLngToLayerPoint(n),s.distanceTo(i);o||L.marker.measurement(n,t(m),r.lang.totalLength,0,r).addTo(this._measurementLayer)}return this},_getRotation:function(t,e){var n=this._map.project(t),s=this._map.project(e);return Math.atan((s.y-n.y)/(s.x-n.x))}}),L.Polyline.addInitHook(function(){e.call(this)})}();